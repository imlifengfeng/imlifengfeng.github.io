<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>iOS开发之Autolayout | 李峰峰博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">iOS开发之Autolayout</h1><a id="logo" href="/.">李峰峰博客</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">iOS开发之Autolayout</h1><div class="post-meta">Dec 4, 2016<span> | </span><span class="category"><a href="/categories/iOS/">iOS</a></span></div><div class="post-content"><p><strong>1**</strong>、概述**</p>
<p><strong>在以前的**</strong>iOS<strong><strong>程序中，是如何设置布局</strong></strong>UI<strong>**界面的？</strong></p>
<p>（1）经常编写大量的坐标计算代码</p>
<p>（2）为了保证在3.5 inch和4.0 inch屏幕上都能有完美的UI界面效果，有时还需要分别为2种屏幕编写不同的坐标计算代码（即传说中的“屏幕适配”）</p>
<p><strong>什么是**</strong>Autolayout<strong>**？</strong></p>
<p>（1）Autolayout是一种“自动布局”技术，专门用来布局UI界面的</p>
<p>（2）Autolayout自iOS 6开始引入，由于Xcode 4的不给力，当时并没有得到很大推广</p>
<p>（3）自iOS 7（Xcode 5）开始，Autolayout的开发效率得到很大的提升</p>
<p>（4）苹果官方也推荐开发者尽量使用Autolayout来布局UI界面</p>
<p>（5）Autolayout能很轻松地解决屏幕适配的问题</p>
<p><strong>Autoresizing</strong></p>
<p>（1）在Autolayout之前，有Autoresizing可以作屏幕适配，但局限性较大，有些任务根本无法完成</p>
<p>（2）相比之下，Autolayout的功能比Autoresizing强大很多</p>
<p><strong>Autolayout**</strong>的<strong><strong>2</strong></strong>个核心概念：**</p>
<p>（1）参照</p>
<p>（2）约束</p>
<p><strong>2**</strong>、<strong><strong>Autolayout</strong></strong>的警告和错误**</p>
<p><strong>警告：</strong></p>
<p>控件的frame不匹配所添加的约束, 比如：</p>
<p>约束控件的宽度为100, 而控件现在的宽度是110</p>
<p><strong>错误：</strong></p>
<p>缺乏必要的约束, 比如：</p>
<p>只约束了宽度和高度, 没有约束具体的位置</p>
<p>两个约束冲突, 比如：</p>
<p>1个约束控件的宽度为100, 1个约束控件的宽度为110</p>
<p><strong>3**</strong>、代码实现<strong>**Autolayout</strong></p>
<p>代码实现Autolayout的步骤：</p>
<p>第一步：利用NSLayoutConstraint类创建具体的约束对象</p>
<p>第二步：添加约束对象到相应的view上</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- <span class="params">(void)</span>addConstraint:<span class="params">(NSLayoutConstraint *)</span>constraint;</span><br><span class="line"></span><br><span class="line">- <span class="params">(void)</span>addConstraints:<span class="params">(NSArray *)</span>constraints;</span><br></pre></td></tr></table></figure>
<p>代码实现Autolayout的注意点：</p>
<p>（1）要先禁止autoresizing功能，设置view的下面属性为NO</p>
<p>view.translatesAutoresizingMaskIntoConstraints = NO;</p>
<p>（2）添加约束之前，一定要保证相关控件都已经在各自的父控件上</p>
<p>（3）<strong>不用再给**</strong>view<strong><strong>设置</strong></strong>frame**</p>
<p><strong>4**</strong>、<strong>**NSLayoutConstraint</strong></p>
<p>一个NSLayoutConstraint对象就代表一个约束。</p>
<p>创建约束对象的常用方法：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+(<span class="keyword">id</span>)constraintWithItem:(<span class="keyword">id</span>)view1 attribute:(<span class="built_in">NSLayoutAttribute</span>)attr1 relatedBy:(<span class="built_in">NSLayoutRelation</span>)relation toItem:(<span class="keyword">id</span>)view2 attribute:(<span class="built_in">NSLayoutAttribute</span>)attr2 multiplier:(<span class="built_in">CGFloat</span>)multiplier constant:(<span class="built_in">CGFloat</span>)c;</span><br></pre></td></tr></table></figure>
<p>view1 ：要约束的控件</p>
<p>attr1 ：约束的类型（做怎样的约束）</p>
<p>relation ：与参照控件之间的关系</p>
<p>view2 ：参照的控件</p>
<p>attr2 ：约束的类型（做怎样的约束）</p>
<p>multiplier ：乘数</p>
<p>c ：常量</p>
<p><strong>自动布局有个核心公式：</strong></p>
<p>obj1.property1 =（obj2.property2 * multiplier）+ constant value</p>
<p>例如：实现下面效果：</p>
<p><img src="http://static.oschina.net/uploads/img/201508/31205309_jqMs.png" alt=""></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">(void)viewDidLoad</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line">    <span class="string">[super</span> <span class="string">viewDidLoad];</span></span><br><span class="line">   </span><br><span class="line">    <span class="string">//</span> <span class="number">1.</span><span class="string">添加控件</span></span><br><span class="line">    <span class="string">UIView</span> <span class="meta">*blueView</span> <span class="string">=</span> <span class="string">[[UIView</span> <span class="string">alloc]</span> <span class="string">init];</span></span><br><span class="line">    <span class="string">blueView.backgroundColor</span> <span class="string">=</span> <span class="string">[UIColor</span> <span class="string">blueColor];</span></span><br><span class="line">    <span class="string">blueView.translatesAutoresizingMaskIntoConstraints</span> <span class="string">=</span> <span class="literal">NO</span><span class="string">;</span></span><br><span class="line">    <span class="string">[self.view</span> <span class="attr">addSubview:blueView];</span></span><br><span class="line">   </span><br><span class="line">    <span class="string">UIView</span> <span class="meta">*redView</span> <span class="string">=</span> <span class="string">[[UIView</span> <span class="string">alloc]</span> <span class="string">init];</span></span><br><span class="line">    <span class="string">redView.backgroundColor</span> <span class="string">=</span> <span class="string">[UIColor</span> <span class="string">redColor];</span></span><br><span class="line">    <span class="string">redView.translatesAutoresizingMaskIntoConstraints</span> <span class="string">=</span> <span class="literal">NO</span><span class="string">;</span></span><br><span class="line">    <span class="string">[self.view</span> <span class="attr">addSubview:redView];</span></span><br><span class="line">   </span><br><span class="line">    <span class="string">//</span> <span class="number">2.</span><span class="string">约束蓝色</span></span><br><span class="line">    <span class="string">//</span> <span class="number">2.1</span><span class="string">.高度</span></span><br><span class="line"><span class="string">NSLayoutConstraint</span> <span class="meta">*blueHeight</span> <span class="string">=</span></span><br><span class="line"><span class="string">[NSLayoutConstraint</span> <span class="attr">constraintWithItem:blueView</span> <span class="attr">attribute:</span></span><br><span class="line"><span class="string">NSLayoutAttributeHeight</span> <span class="attr">relatedBy:NSLayoutRelationEqual</span> <span class="attr">toItem:</span></span><br><span class="line"><span class="string">nil</span> <span class="attr">attribute:NSLayoutAttributeNotAnAttribute</span> <span class="attr">multiplier:1.0</span></span><br><span class="line"><span class="attr">constant:</span><span class="number">40</span><span class="string">];</span></span><br><span class="line">    <span class="string">[blueView</span> <span class="attr">addConstraint:blueHeight];</span></span><br><span class="line">    <span class="string">//</span> <span class="number">2.2</span><span class="string">.左边间距</span></span><br><span class="line">    <span class="string">CGFloat</span> <span class="string">margin</span> <span class="string">=</span> <span class="number">20</span><span class="string">;</span></span><br><span class="line"><span class="string">NSLayoutConstraint</span> <span class="meta">*blueLeft</span> <span class="string">=</span></span><br><span class="line"><span class="string">[NSLayoutConstraint</span> <span class="attr">constraintWithItem:blueView</span> <span class="attr">attribute:</span></span><br><span class="line"><span class="string">NSLayoutAttributeLeft</span> <span class="attr">relatedBy:NSLayoutRelationEqual</span> <span class="attr">toItem:</span></span><br><span class="line"><span class="string">self.view</span> <span class="attr">attribute:NSLayoutAttributeLeft</span> <span class="attr">multiplier:1.0</span> <span class="attr">constant:</span></span><br><span class="line"><span class="string">margin];</span></span><br><span class="line">    <span class="string">[self.view</span> <span class="attr">addConstraint:blueLeft];</span></span><br><span class="line">    <span class="string">//</span> <span class="number">2.3</span><span class="string">.顶部间距</span></span><br><span class="line"><span class="string">NSLayoutConstraint</span> <span class="meta">*blueTop</span> <span class="string">=</span></span><br><span class="line"><span class="string">[NSLayoutConstraint</span> <span class="attr">constraintWithItem:blueView</span> <span class="attr">attribute:</span></span><br><span class="line"><span class="string">NSLayoutAttributeTop</span> <span class="attr">relatedBy:NSLayoutRelationEqual</span> <span class="attr">toItem:</span></span><br><span class="line"><span class="string">self.view</span> <span class="attr">attribute:NSLayoutAttributeTop</span> <span class="attr">multiplier:1.0</span> <span class="attr">constant:</span></span><br><span class="line"><span class="string">margin];</span></span><br><span class="line">    <span class="string">[self.view</span> <span class="attr">addConstraint:blueTop];</span></span><br><span class="line">    <span class="string">//</span> <span class="number">2.4</span><span class="string">.右边间距</span></span><br><span class="line"><span class="string">NSLayoutConstraint</span> <span class="meta">*blueRight</span> <span class="string">=</span></span><br><span class="line"> <span class="string">[NSLayoutConstraint</span> <span class="attr">constraintWithItem:blueView</span> <span class="attr">attribute:</span></span><br><span class="line"><span class="string">NSLayoutAttributeRight</span> <span class="attr">relatedBy:NSLayoutRelationEqual</span> <span class="attr">toItem:</span></span><br><span class="line"><span class="string">self.view</span> <span class="attr">attribute:NSLayoutAttributeRight</span> <span class="attr">multiplier:1.0</span> <span class="attr">constant:</span></span><br><span class="line"><span class="bullet">-</span><span class="string">margin];</span></span><br><span class="line">    <span class="string">[self.view</span> <span class="attr">addConstraint:blueRight];</span></span><br><span class="line">   </span><br><span class="line">    <span class="string">//</span> <span class="number">3.</span><span class="string">约束红色</span></span><br><span class="line">    <span class="string">//</span> <span class="number">3.1</span><span class="string">.让红色右边</span> <span class="string">==</span> <span class="string">蓝色右边</span></span><br><span class="line"><span class="string">NSLayoutConstraint</span> <span class="meta">*redRight</span> <span class="string">=</span></span><br><span class="line"><span class="string">[NSLayoutConstraint</span> <span class="attr">constraintWithItem:redView</span> <span class="attr">attribute:</span></span><br><span class="line"><span class="string">NSLayoutAttributeRight</span> <span class="attr">relatedBy:NSLayoutRelationEqual</span> <span class="attr">toItem:</span></span><br><span class="line"><span class="string">blueView</span> <span class="attr">attribute:NSLayoutAttributeRight</span> <span class="attr">multiplier:1.0</span></span><br><span class="line"><span class="attr">constant:</span><span class="number">0.0</span><span class="string">];</span></span><br><span class="line">    <span class="string">[self.view</span> <span class="attr">addConstraint:redRight];</span></span><br><span class="line"> </span><br><span class="line">    <span class="string">//</span> <span class="number">3.2</span><span class="string">.让红色高度</span> <span class="string">==</span> <span class="string">蓝色高度</span></span><br><span class="line"><span class="string">NSLayoutConstraint</span> <span class="meta">*redHeight</span> <span class="string">=</span></span><br><span class="line"><span class="string">[NSLayoutConstraint</span> <span class="attr">constraintWithItem:redView</span> <span class="attr">attribute:</span></span><br><span class="line"><span class="string">NSLayoutAttributeHeight</span> <span class="attr">relatedBy:NSLayoutRelationEqual</span> <span class="attr">toItem:</span></span><br><span class="line"><span class="string">blueView</span> <span class="attr">attribute:NSLayoutAttributeHeight</span> <span class="attr">multiplier:1.0</span> <span class="attr">constant:</span></span><br><span class="line"><span class="number">0.0</span><span class="string">];</span></span><br><span class="line">    <span class="string">[self.view</span> <span class="attr">addConstraint:redHeight];</span></span><br><span class="line">   </span><br><span class="line">    <span class="string">//</span> <span class="number">3.3</span><span class="string">.让红色顶部</span> <span class="string">==</span> <span class="string">蓝色底部</span> <span class="string">+</span> <span class="string">间距</span></span><br><span class="line"><span class="string">NSLayoutConstraint</span> <span class="meta">*redTop</span> <span class="string">=</span></span><br><span class="line"><span class="string">[NSLayoutConstraint</span> <span class="attr">constraintWithItem:redView</span> <span class="attr">attribute:</span></span><br><span class="line"><span class="string">NSLayoutAttributeTop</span> <span class="attr">relatedBy:NSLayoutRelationEqual</span> <span class="attr">toItem:</span></span><br><span class="line"><span class="string">blueView</span> <span class="attr">attribute:NSLayoutAttributeBottom</span> <span class="attr">multiplier:1.0</span> <span class="attr">constant:</span></span><br><span class="line"><span class="string">margin];</span></span><br><span class="line">    <span class="string">[self.view</span> <span class="attr">addConstraint:redTop];</span></span><br><span class="line">   </span><br><span class="line">    <span class="string">//</span> <span class="number">3.4</span><span class="string">.让红色宽度</span> <span class="string">==</span> <span class="string">蓝色宽度</span> <span class="string">*</span> <span class="number">0.5</span></span><br><span class="line"><span class="string">NSLayoutConstraint</span> <span class="meta">*redWidth</span> <span class="string">=</span></span><br><span class="line"><span class="string">[NSLayoutConstraint</span> <span class="attr">constraintWithItem:redView</span> <span class="attr">attribute:</span></span><br><span class="line"><span class="string">NSLayoutAttributeWidth</span> <span class="attr">relatedBy:NSLayoutRelationEqual</span> <span class="attr">toItem:</span></span><br><span class="line"><span class="string">blueView</span> <span class="attr">attribute:NSLayoutAttributeWidth</span> <span class="attr">multiplier:0.5</span> <span class="attr">constant:</span></span><br><span class="line"><span class="number">0.0</span><span class="string">];</span></span><br><span class="line">    <span class="string">[self.view</span> <span class="attr">addConstraint:redWidth];</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>5**</strong>、添加约束的规则**</p>
<p>在创建约束之后，需要将其添加到作用的view上。</p>
<p>在添加时要注意目标view需要遵循以下规则：</p>
<p>（1）对于两个同层级view之间的约束关系，添加到它们的父view上</p>
<p><img src="http://static.oschina.net/uploads/img/201508/31205309_qAoN.png" alt=""></p>
<p>（2）对于两个不同层级view之间的约束关系，添加到他们最近的共同父view上</p>
<p><img src="http://static.oschina.net/uploads/img/201508/31205309_cek6.png" alt=""></p>
<p>（3）对于有层次关系的两个view之间的约束关系，添加到层次较高的父view上</p>
<p><img src="http://static.oschina.net/uploads/img/201508/31205309_Ghbt.png" alt=""></p>
<p><strong>6**</strong>、<strong><strong>VFL</strong></strong>语言**</p>
<p>什么是VFL语言？</p>
<p>VFL全称是Visual Format Language，翻译过来是“可视化格式语言”，是苹果公司为了简化Autolayout的编码而推出的抽象语言。</p>
<p><img src="http://static.oschina.net/uploads/img/201508/31205311_gpgd.png" alt=""></p>
<p><strong>7**</strong>、<strong><strong>VFL</strong></strong>示例**</p>
<p>H:[cancelButton(72)]-12-[acceptButton(50)]</p>
<p>canelButton宽72，acceptButton宽50，它们之间间距12</p>
<p>H:[wideView(&gt;=60@700)]</p>
<p>wideView宽度大于等于60point，该约束条件优先级为700（优先级最大值为1000，优先级越高的约束越先被满足）</p>
<p>V:[redBox]-[yellowBox(==redBox)]</p>
<p>竖直方向上，先有一个redBox，其下方紧接一个高度等于redBox高度的yellowBox</p>
<p>H:|-10-[Find]-[FindNext]-[FindField(&gt;=20)]-|</p>
<p>水平方向上，Find距离父view左边缘默认间隔宽度，之后是FindNext距离Find间隔默认宽度；再之后是宽度不小于20的FindField，它和FindNext以及父view右边缘的间距都是默认宽度。（竖线“|” 表示superview的边缘）</p>
<p><strong>8**</strong>、<strong><strong>VFL</strong></strong>的使用**</p>
<p>使用VFL来创建约束数组：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">NSArray</span> *)constraintsWithVisualFormat:(<span class="built_in">NSString</span> *)format options:(<span class="built_in">NSLayoutFormatOptions</span>)opts metrics:(<span class="built_in">NSDictionary</span> *)metrics views:(<span class="built_in">NSDictionary</span> *)views;</span><br></pre></td></tr></table></figure>
<p>format ：VFL语句</p>
<p>opts ：约束类型</p>
<p>metrics ：VFL语句中用到的具体数值</p>
<p>views ：VFL语句中用到的控件</p>
<p>创建一个字典（内部包含VFL语句中用到的控件）的快捷宏定义：</p>
<p>NSDictionaryOfVariableBindings(…)</p>
<p>例如：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">NSDictionary *views =</span><br><span class="line"></span><br><span class="line">NSDictionaryOfVariableBindings(blueView, redView);</span><br><span class="line"></span><br><span class="line">NSArray *conts2 =</span><br><span class="line"></span><br><span class="line">[NSLayoutConstraint <span class="string">constraintsWithVisualFormat:</span></span><br><span class="line"></span><br><span class="line">@<span class="string">"V:[blueView(==blueHeight)]-margin-|"</span> <span class="string">options:</span><span class="number">0</span> <span class="string">metrics:</span></span><br><span class="line"></span><br><span class="line">@&#123;@<span class="string">"blueHeight"</span> : @<span class="number">40</span>, @<span class="string">"margin"</span> : @<span class="number">20</span>&#125; <span class="string">views:</span>views];</span><br></pre></td></tr></table></figure>
<p>示例代码：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 1.添加控件</span></span><br><span class="line">    <span class="built_in">UIView</span> *blueView = [[<span class="built_in">UIView</span> alloc] init];</span><br><span class="line">    blueView.backgroundColor = [<span class="built_in">UIColor</span> blueColor];</span><br><span class="line">    blueView.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:blueView];</span><br><span class="line">   </span><br><span class="line">    <span class="built_in">UIView</span> *redView = [[<span class="built_in">UIView</span> alloc] init];</span><br><span class="line">    redView.backgroundColor = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line">    redView.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:redView];</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 2.VFL生成约束</span></span><br><span class="line"><span class="built_in">NSArray</span> *conts =</span><br><span class="line"> [<span class="built_in">NSLayoutConstraint</span> constraintsWithVisualFormat:</span><br><span class="line"><span class="string">@"H:|-20-[blueView]-20-|"</span> options:<span class="number">0</span> metrics:<span class="literal">nil</span> views:</span><br><span class="line">@&#123;<span class="string">@"blueView"</span> : blueView&#125;];</span><br><span class="line">    [<span class="keyword">self</span>.view addConstraints:conts];</span><br><span class="line">   </span><br><span class="line"><span class="built_in">NSArray</span> *conts2 =</span><br><span class="line"> [<span class="built_in">NSLayoutConstraint</span> constraintsWithVisualFormat:</span><br><span class="line"><span class="string">@"V:|-20-[blueView(40)]-20-[redView(==blueView)]"</span> options:<span class="built_in">NSLayoutFormatAlignAllRight</span> metrics:<span class="literal">nil</span> views:@&#123;<span class="string">@"blueView"</span> : blueView, <span class="string">@"redView"</span> : redView&#125;];</span><br><span class="line">    [<span class="keyword">self</span>.view addConstraints:conts2];</span><br><span class="line">   </span><br><span class="line"><span class="built_in">NSLayoutConstraint</span> *redWidth =</span><br><span class="line"> [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:redView attribute:</span><br><span class="line"><span class="built_in">NSLayoutAttributeWidth</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:</span><br><span class="line">blueView attribute:<span class="built_in">NSLayoutAttributeWidth</span> multiplier:<span class="number">0.5</span> constant:</span><br><span class="line"><span class="number">0.0</span>];</span><br><span class="line">    [<span class="keyword">self</span>.view addConstraint:redWidth];</span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><code></code>运行效果图：</p>
<p><img src="http://static.oschina.net/uploads/img/201508/31205311_JL2n.png" alt=""></p>
<p><strong>9**</strong>、<strong><strong>有了</strong></strong>Autolayout<strong><strong>的</strong></strong>UILabel**</p>
<p>在没有Autolayout之前，UILabel的文字内容总是居中显示，导致顶部和底部会有一大片空缺区域：</p>
<p><img src="http://static.oschina.net/uploads/img/201508/31205311_0QtM.png" alt=""></p>
<p>有Autolayout之后，UILabel的bounds默认会自动包住所有的文字内容，顶部和底部不再会有空缺区域：</p>
<p><img src="http://static.oschina.net/uploads/img/201508/31205311_YRzi.png" alt=""></p>
<p><strong>10**</strong>、<strong><strong>基于</strong></strong>Autolayout<strong>**的动画</strong></p>
<p>在修改了约束之后，只要执行下面代码，就能做动画效果：</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="name">UIView</span> animateWithDuration:1.0 animations:^&#123;</span><br><span class="line"></span><br><span class="line">[<span class="name">添加了约束的view</span> layoutIfNeeded]<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">&#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.leftMargin.constant = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">self</span>.width.constant = <span class="number">200</span>;</span><br><span class="line">[<span class="built_in">UIView</span> animateWithDuration:<span class="number">2.0</span> animations:^&#123;</span><br><span class="line">     <span class="comment">//父控件和redView都添加了约束</span></span><br><span class="line">     [<span class="keyword">self</span>.view layoutIfNeeded];</span><br><span class="line">     [<span class="keyword">self</span>.redView layoutIfNeeded];</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>更多内容与学习交流请关注个人微信公众账号：极客峰</p>
<p><a href="http://static.oschina.net/uploads/space/2016/0527/002254_QrEI_2448717.jpg" target="_blank" rel="noopener"><img src="http://static.oschina.net/uploads/space/2016/0527/002254_QrEI_2448717.jpg" alt=""></a></p>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>imlifengfeng</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/article/16/">https://imlifengfeng.github.io/article/16/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>原创文章，转载请注明来源</li></ul></div><br><div class="tags"><a href="/tags/Autolayout/">Autolayout</a></div><div class="post-nav"><a class="pre" href="/article/17/">iOS开发之触摸事件及手势</a><a class="next" href="/article/15/">教你破解隔壁妹子的wifi密码，成功率高达90%</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: 'c364198c7db8ed6a1011',
  clientSecret: '7613c9d1c4706bdebff2c7adf84efdf98839ec7d',
  repo: 'imlifengfeng.github.io',
  owner: 'imlifengfeng',
  admin: ['imlifengfeng'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="https://imlifengfeng.github.io"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/教程/">教程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/article/714/">iOS 的组件化开发</a></li><li class="post-list-item"><a class="post-list-link" href="/article/692/">iOS逆向工程之fishhook</a></li><li class="post-list-item"><a class="post-list-link" href="/article/677/">iOS逆向工程之插件开发</a></li><li class="post-list-item"><a class="post-list-link" href="/article/674/">Swift算法实现之归并排序</a></li><li class="post-list-item"><a class="post-list-link" href="/article/672/">Swift算法实现之快速排序</a></li><li class="post-list-item"><a class="post-list-link" href="/article/669/">Swift算法实现之翻转二叉树</a></li><li class="post-list-item"><a class="post-list-link" href="/article/661/">Swift算法实现之二叉树</a></li><li class="post-list-item"><a class="post-list-link" href="/article/658/">Swift算法实现之栈和队列</a></li><li class="post-list-item"><a class="post-list-link" href="/article/654/">Swift算法实现之查找第K大的元素</a></li><li class="post-list-item"><a class="post-list-link" href="/article/652/">Swift算法实现之数组中出现次数超过一半的数字</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">李峰峰博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>